# Ollama 버전 요구사항 분석

## 현재 사용 중인 Ollama API

### 1. GET /api/tags
- **용도**: 모델 목록 조회
- **사용 위치**: 
  - `ollama_client.py::verify_connection()`
  - `app.py::SSE 스트림` (Ollama 상태 확인)
- **최소 버전**: **Ollama 0.1.0+** (초기 버전부터 지원)
- **필수 파라미터**: 없음
- **응답 형식**: `{"models": [{"name": "...", ...}]}`

### 2. POST /api/generate
- **용도**: 텍스트 생성 (코인 스캔, 매매 결정, AI Q&A)
- **사용 위치**:
  - `ollama_client.py::generate()`
  - `coin_scanner.py::scan_single_market()`
  - `trading_decision.py::make_decision()`
  - `app.py::ai_query()` (AI Q&A)
- **최소 버전**: **Ollama 0.1.0+** (초기 버전부터 지원)
- **필수 파라미터**:
  - `model`: string (필수)
  - `prompt`: string (필수)
- **선택 파라미터**:
  - `stream`: bool (기본값: false) - **현재 코드는 false 사용**
  - `temperature`: float (기본값: 0.3) - **현재 코드는 0.2~0.5 사용**
- **응답 형식**: `{"response": "...", "done": true, ...}`

## 사용하지 않는 기능 (제거 가능)

### ❌ 사용 안함
- `/api/chat` - 최신 대화형 API (0.8.0+)
- `/api/embeddings` - 임베딩 생성 (0.5.0+)
- `/api/show` - 모델 상세 정보 (0.3.0+)
- 스트리밍 (`stream: true`) - 실시간 스트림
- 고급 파라미터:
  - `top_p`, `top_k` - 샘플링 파라미터
  - `num_predict` - 최대 토큰 수
  - `repeat_penalty` - 반복 패널티
  - `context` - 컨텍스트 전달

## 각 작업별 최소 버전

### 작업 1: 모델 목록 조회 (`/api/tags`)
- **최소 버전**: **Ollama 0.1.0**
- **안전 버전**: **Ollama 0.3.0** (버그 수정)
- **사용 빈도**: 낮음 (초기 연결 확인 시만)

### 작업 2: 코인 스캔 (`/api/generate` - 스캐너)
- **최소 버전**: **Ollama 0.1.0**
- **안전 버전**: **Ollama 0.3.0**
- **사용 빈도**: 높음 (50개 코인 × 2-3분 간격)
- **파라미터**: `model`, `prompt`, `stream=false`, `temperature=0.3`

### 작업 3: 매매 결정 (`/api/generate` - 결정자)
- **최소 버전**: **Ollama 0.1.0**
- **안전 버전**: **Ollama 0.3.0**
- **사용 빈도**: 중간 (매매 사이클마다)
- **파라미터**: `model`, `prompt`, `stream=false`, `temperature=0.3~0.5`

### 작업 4: AI Q&A (`/api/generate` - Q&A)
- **최소 버전**: **Ollama 0.1.0**
- **안전 버전**: **Ollama 0.3.0**
- **사용 빈도**: 낮음 (사용자 요청 시)
- **파라미터**: `model`, `prompt`, `stream=false`, `temperature=0.2`

## 종합 최소 버전 요구사항

### ✅ 최소 버전: **Ollama 0.1.0**
- 모든 필수 API 지원
- 기본 파라미터 모두 사용 가능
- **단점**: 초기 버전이라 버그 가능성

### ✅ 권장 최소 버전: **Ollama 0.3.0**
- 안정성 개선
- 버그 수정
- 성능 최적화
- **장점**: 안정적이고 검증된 버전

### ✅ 현재 설치 버전: **Ollama 0.12.7**
- 최신 기능 모두 사용 가능
- 최고 성능 및 안정성
- **장점**: 모든 기능 사용 가능

## 버전 다운그레이드 시 주의사항

### Ollama 0.1.0 → 0.3.0 사용 시
1. ✅ **문제 없음**: 모든 필수 기능 지원
2. ✅ **코드 변경 불필요**: 현재 코드 그대로 사용 가능
3. ⚠️ **성능 차이**: 최신 버전 대비 약간 느릴 수 있음

### Ollama 0.3.0 이하 사용 시
1. ⚠️ **버그 가능성**: 초기 버전의 알려진 버그
2. ⚠️ **성능 저하**: 최적화가 덜 된 버전
3. ✅ **기능 호환**: 모든 필수 기능은 작동

## 최적화 제안

### 현재 코드는 이미 최소 버전 호환
- ✅ 스트리밍 사용 안함 (`stream: false`)
- ✅ 기본 파라미터만 사용
- ✅ 최신 API (`/api/chat`) 미사용
- ✅ 고급 파라미터 미사용

### 추가 최적화 가능 사항
1. **타임아웃 조정**: 낮은 버전은 응답이 느릴 수 있으므로 타임아웃 증가 고려
2. **재시도 로직**: 낮은 버전의 불안정성 대비 재시도 추가
3. **에러 핸들링**: 버전별 에러 메시지 차이 대비

## 결론

**현재 코드는 Ollama 0.1.0 이상에서 모두 작동합니다.**

- **최소 버전**: Ollama 0.1.0 (2023년 초)
- **권장 버전**: Ollama 0.3.0 (안정성)
- **현재 버전**: Ollama 0.12.7 (최신)

**코드 변경 없이 버전 다운그레이드 가능합니다!** ✅

